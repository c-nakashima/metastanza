{"version":3,"file":"vega_barchart.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/vega_barchart/index.js"],"sourcesContent":["import vegaEmbed from \"vega-embed\";\n\nexport default async function vegaBarchart(stanza, params) {\n  let spec = await fetch(params[\"src-url\"]).then((res) => res.json());\n  spec.data[0].values = [\n    {\"category\": \"value1\", \"amount\": 1},\n    {\"category\": \"value2\", \"amount\": 7},\n    {\"category\": \"value3\", \"amount\": 5},\n    {\"category\": \"value4\", \"amount\": 9},\n  ]\n\n  //stanza（描画範囲）のwidth・height\n  spec.width = params[\"width\"]; \n  spec.height = params[\"height\"];\n  // spec.width = \"var(--width)\"\n  // spec.height = \"var(--height)\"\n  \n  //stanzaのpadding\n  spec.padding = params[\"padding\"];\n\n  //イベントなど設定できるかと思ったができない\n  // spec.signals[0].on[0].events = \"click\"\n  // spec.signals[0].on[1].events = \"click\"\n\n  //棒・スケールに関する設定\n  spec.scales[0].paddingInner = params[\"padding-inner\"]\n  spec.scales[0].paddingOuter = params[\"padding-outer\"]\n\n  //軸に関する設定\n  spec.axes[0].orient = params[\"orient-of-xscale\"]\n  spec.axes[1].orient = params[\"orient-of-yscale\"]\n  spec.axes[0].title = params[\"title-of-xaxis\"]\n  spec.axes[1].title = params[\"title-of-yaxis\"]\n  spec.axes[0].encode = {\n    \"ticks\": {\n      \"update\": {\n      \"stroke\": {\"value\": params[\"tick-color\"]}\n      }\n    },\n    \"labels\": {\n      \"interactive\": true,\n      \"update\": {\n        \"fill\": {\"value\": params[\"label-color\"]},\n        \"fontSize\": {\"value\": params[\"label-size\"]},\n      },\n      \"hover\": {\n        \"fill\": {\"value\": \"var(--emphasized-color)\"}\n      }\n    },\n    \"title\": {\n      \"update\": {\n        \"fontSize\": {\"value\": params[\"title-size\"]}\n      }\n    },\n    \"domain\": {\n      \"update\": {\n        \"stroke\": {\"value\": params[\"axis-color\"]},\n        \"strokeWidth\": {\"value\": params[\"axis-width\"]}\n      }\n    }\n  }\n\n  spec.axes[1].encode = {\n    \"ticks\": {\n      \"update\": {\n      \"stroke\": {\"value\": params[\"tick-color\"]}\n      }\n    },\n    \"labels\": {\n      \"interactive\": true,\n      \"update\": {\n        \"fill\": {\"value\": params[\"label-color\"]},\n        \"fontSize\": {\"value\": params[\"label-size\"]},\n      },\n      \"hover\": {\n        \"fill\": {\"value\": \"var(--emphasized-color)\"}\n      }\n    },\n    \"title\": {\n      \"update\": {\n        \"fontSize\": {\"value\": params[\"title-size\"]}\n      }\n    },\n    \"domain\": {\n      \"update\": {\n        \"stroke\": {\"value\": params[\"axis-color\"]},\n        \"strokeWidth\": {\"value\": params[\"axis-width\"]}\n      }\n    }\n  }\n\n  //rect（棒）の描画について\n  spec.marks[0].encode ={\n    \"enter\": {\n      \"x\": {\"scale\": \"xscale\", \"field\": \"category\"},\n      \"width\": {\"scale\": \"xscale\", \"band\": params[\"bar-width\"]},\n      \"y\": {\"scale\": \"yscale\", \"field\": \"amount\"},\n      \"y2\": {\"scale\": \"yscale\", \"value\": 0},\n    },\n    \"update\": {\n      \"fill\": {\"value\": \"var(--basic-fill-color)\"}\n    },\n    \"hover\": {\n      \"fill\": {\"value\": \"var(--emphasized-color)\"}\n    }\n  }\n\n  spec.marks[1].encode ={\n    \"enter\": {\n      \"align\": {\"value\": \"center\"},\n      \"baseline\": {\"value\": \"bottom\"},\n      \"fill\": {\"value\": \"var(--emphasized-color)\"},\n      \"fontSize\": {value: params[\"fontsize-of-value\"]}\n    },\n    \"update\": {\n      \"x\": {\"scale\": \"xscale\", \"signal\": \"tooltip.category\", \"band\": 0.5},\n      \"y\": {\"scale\": \"yscale\", \"signal\": \"tooltip.amount\", \"offset\": -1},\n      \"text\": {\"signal\": \"tooltip.amount\"},\n      \"fillOpacity\": [\n        {\"test\": \"datum === tooltip\", \"value\": 0},\n        {\"value\": 1}\n      ]\n    }\n  }\n\n\n  // spec.marks[0].encode.update.fill.value = \"var(--bar-color)\"\n  // spec.marks[0].encode.hover.fill.value = \"var(--emphasized-color)\"\n  // spec.marks[1].encode.enter.fill.value = \"var(--emphasized-color)\"\n  // spec.marks[1].encode.enter.fontSize = {value: params[\"fontsize-of-value\"]}\n  // spec.marks[1].encode.enter.fontWeight = {value: params[\"fontweight-of-value\"]}\n\n  const el = stanza.root.querySelector(\"main\");\n  const opts = {\n    renderer: \"svg\"\n  };\n  await vegaEmbed(el, spec, opts);\n}\n"],"names":["vegaEmbed"],"mappings":";;;;;;AAEe,eAAe,YAAY,CAAC,MAAM,EAAE,MAAM,EAAE;AAC3D,EAAE,IAAI,IAAI,GAAG,MAAM,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;AACtE,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG;AACxB,IAAI,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;AACvC,IAAI,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;AACvC,IAAI,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;AACvC,IAAI,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;AACvC,IAAG;AACH;AACA;AACA,EAAE,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;AAC/B,EAAE,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;AACjC;AACA;AACA;AACA;AACA,EAAE,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,YAAY,GAAG,MAAM,CAAC,eAAe,EAAC;AACvD,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,YAAY,GAAG,MAAM,CAAC,eAAe,EAAC;AACvD;AACA;AACA,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC,kBAAkB,EAAC;AAClD,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC,kBAAkB,EAAC;AAClD,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,MAAM,CAAC,gBAAgB,EAAC;AAC/C,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,MAAM,CAAC,gBAAgB,EAAC;AAC/C,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG;AACxB,IAAI,OAAO,EAAE;AACb,MAAM,QAAQ,EAAE;AAChB,MAAM,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AAC/C,OAAO;AACP,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,MAAM,aAAa,EAAE,IAAI;AACzB,MAAM,QAAQ,EAAE;AAChB,QAAQ,MAAM,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,aAAa,CAAC,CAAC;AAChD,QAAQ,UAAU,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACnD,OAAO;AACP,MAAM,OAAO,EAAE;AACf,QAAQ,MAAM,EAAE,CAAC,OAAO,EAAE,yBAAyB,CAAC;AACpD,OAAO;AACP,KAAK;AACL,IAAI,OAAO,EAAE;AACb,MAAM,QAAQ,EAAE;AAChB,QAAQ,UAAU,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACnD,OAAO;AACP,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,MAAM,QAAQ,EAAE;AAChB,QAAQ,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACjD,QAAQ,aAAa,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACtD,OAAO;AACP,KAAK;AACL,IAAG;AACH;AACA,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG;AACxB,IAAI,OAAO,EAAE;AACb,MAAM,QAAQ,EAAE;AAChB,MAAM,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AAC/C,OAAO;AACP,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,MAAM,aAAa,EAAE,IAAI;AACzB,MAAM,QAAQ,EAAE;AAChB,QAAQ,MAAM,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,aAAa,CAAC,CAAC;AAChD,QAAQ,UAAU,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACnD,OAAO;AACP,MAAM,OAAO,EAAE;AACf,QAAQ,MAAM,EAAE,CAAC,OAAO,EAAE,yBAAyB,CAAC;AACpD,OAAO;AACP,KAAK;AACL,IAAI,OAAO,EAAE;AACb,MAAM,QAAQ,EAAE;AAChB,QAAQ,UAAU,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACnD,OAAO;AACP,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,MAAM,QAAQ,EAAE;AAChB,QAAQ,QAAQ,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACjD,QAAQ,aAAa,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;AACtD,OAAO;AACP,KAAK;AACL,IAAG;AACH;AACA;AACA,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;AACxB,IAAI,OAAO,EAAE;AACb,MAAM,GAAG,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,UAAU,CAAC;AACnD,MAAM,OAAO,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,WAAW,CAAC,CAAC;AAC/D,MAAM,GAAG,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC;AACjD,MAAM,IAAI,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,CAAC,CAAC;AAC3C,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,MAAM,MAAM,EAAE,CAAC,OAAO,EAAE,yBAAyB,CAAC;AAClD,KAAK;AACL,IAAI,OAAO,EAAE;AACb,MAAM,MAAM,EAAE,CAAC,OAAO,EAAE,yBAAyB,CAAC;AAClD,KAAK;AACL,IAAG;AACH;AACA,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;AACxB,IAAI,OAAO,EAAE;AACb,MAAM,OAAO,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC;AAClC,MAAM,UAAU,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC;AACrC,MAAM,MAAM,EAAE,CAAC,OAAO,EAAE,yBAAyB,CAAC;AAClD,MAAM,UAAU,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC,mBAAmB,CAAC,CAAC;AACtD,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,MAAM,GAAG,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,kBAAkB,EAAE,MAAM,EAAE,GAAG,CAAC;AACzE,MAAM,GAAG,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,gBAAgB,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;AACxE,MAAM,MAAM,EAAE,CAAC,QAAQ,EAAE,gBAAgB,CAAC;AAC1C,MAAM,aAAa,EAAE;AACrB,QAAQ,CAAC,MAAM,EAAE,mBAAmB,EAAE,OAAO,EAAE,CAAC,CAAC;AACjD,QAAQ,CAAC,OAAO,EAAE,CAAC,CAAC;AACpB,OAAO;AACP,KAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAC/C,EAAE,MAAM,IAAI,GAAG;AACf,IAAI,QAAQ,EAAE,KAAK;AACnB,GAAG,CAAC;AACJ,EAAE,MAAMA,KAAS,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;AAClC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}