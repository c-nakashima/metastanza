{"version":3,"file":"vega_tree.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/vega_tree/index.js"],"sourcesContent":["import vegaEmbed from \"vega-embed\";\n\nexport default async function vegaTree(stanza, params) {\n  let spec = await fetch(params[\"src-url\"]).then((res) => res.json());\n  spec.data[0].url =\"https://vega.github.io/vega/data/flare.json\"\n\n  //stanza（描画範囲）のwidth・height\n  spec.width = params[\"width\"]; \n  spec.height = params[\"width\"];\n  \n  //stanzaのpadding\n  spec.padding = params[\"padding\"];\n\n  //scales\n  spec.scales[0].range = {\"scheme\": params[\"color-scheme\"]}\n  // spec.scales[0].range = [\n  //   'var(--series-0-color)',\n  //   'var(--series-1-color)',\n  //   'var(--series-2-color)',\n  //   'var(--series-3-color)',\n  //   'var(--series-4-color)',\n  //   'var(--series-5-color)'\n  // ]\n\n  //Marks:描画について\n  spec.marks[0].encode ={\n    \"update\": {\n      \"path\": {\"field\": \"path\"},\n      \"stroke\": {\"value\": \"var(--branch-color)\"}\n    },\n    \"hover\": {\n      \"stroke\": {\"value\": \"var(--emphasized-color)\"}\n    }\n  }\n\n  spec.marks[1].encode ={\n    \"enter\": {\n      \"size\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--node-size\")},\n      \"stroke\": {\"value\": \"var(--stroke-color)\"}\n    },\n    \"update\": {\n      \"x\": {\"field\": \"x\"},\n      \"y\": {\"field\": \"y\"},\n      \"fill\": {\"scale\": \"color\", \"field\": \"depth\"}\n    },\n    \"hover\": {\n      \"fill\": {\"value\": \"var(--emphasized-color)\"}\n    }\n  }\n\n  spec.marks[2].encode ={\n    \"enter\": {\n      \"text\": {\"field\": \"name\"},\n      \"font\":{\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--label-font\")},\n      \"fontSize\": {\"value\": params[\"label-size\"]},\n      \"baseline\": {\"value\": \"middle\"},\n    },\n    \"update\": {\n      \"x\": {\"field\": \"x\"},\n      \"y\": {\"field\": \"y\"},\n      \"dx\": {\"signal\": \"datum.children ? -7 : 7\"},\n      \"align\": {\"signal\": \"datum.children ? 'right' : 'left'\"},\n      \"opacity\": {\"signal\": \"labels ? 1 : 0\"},\n      \"fill\": {\"value\": \"var(--label-color)\"}\n    },\n    \"hover\": {\n      \"fill\": {\"value\": \"var(--emphasized-color)\"}\n    }\n  }\n\n  const el = stanza.root.querySelector(\"main\");\n  const opts = {\n    renderer: \"svg\"\n  };\n  await vegaEmbed(el, spec, opts);\n}\n"],"names":["vegaEmbed"],"mappings":"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"}